## 핵심 모듈 (필수)

1. **`ollama_client.py`**
   - Ollama API와 통신하는 클라이언트
   - gemma2 모델 호출 (completion)
   - embedding 생성 (ollama embedding API 활용)
   - 연결 관리 및 에러 핸들링

2. **`embedding.py`**
   - 마크다운 문서를 벡터로 변환
   - 텍스트 청킹 (문서를 적절한 크기로 분할)
   - 메타데이터 추출 및 관리
   - 배치 임베딩 처리

3. **`vector_store.py`**
   - 벡터 DB 관리 (ChromaDB 또는 FAISS 추천)
   - 임베딩 저장/로드
   - 유사도 검색 (similarity search)
   - 인덱스 관리 (추가/삭제/업데이트)

4. **`rag.py`**
   - RAG 파이프라인 구현
   - 쿼리 처리 및 검색
   - 컨텍스트 구성
   - gemma2를 통한 답변 생성
   - 프롬프트 템플릿 관리

5. **`indexer.py`**
   - output 폴더의 마크다운 파일 자동 인덱싱
   - 새 파일 감지 및 업데이트
   - 배치 인덱싱 기능
   - 인덱싱 상태 관리

## 지원 모듈 (권장)

6. **`config.py`**
   - Ollama 설정 (URL, 모델명, 파라미터)
   - 벡터 DB 설정
   - 청킹 파라미터 (chunk_size, overlap)
   - RAG 하이퍼파라미터 (top_k, temperature 등)

7. **`schemas.py`** (또는 `models.py`)
   - Pydantic 모델 정의
   - RAG 요청/응답 스키마
   - 인덱싱 관련 데이터 모델

## 선택 모듈 (확장 기능)

8. **`chunking.py`**
   - 다양한 청킹 전략 (고정 크기, 문단 기반, 의미 기반)
   - 마크다운 구조 인식 청킹
   - 오버랩 처리

9. **`retriever.py`**
   - 검색 로직 세분화
   - 하이브리드 검색 (벡터 + 키워드)
   - 리랭킹 (re-ranking)

## FastAPI 엔드포인트 추가

기존 **converter.py**에 추가할 엔드포인트:
- `POST /index` - 문서 인덱싱
- `POST /query` - RAG 질의응답
- `GET /documents` - 인덱싱된 문서 목록
- `DELETE /index/{doc_id}` - 특정 문서 삭제

또는 **`rag_api.py`** 별도 생성도 고려할 수 있습니다.






**하나씩 순서대로 생성하면서 진행하는 것을 추천합니다.** 이유는:

## 장점

1. **의존성 관리** - 각 모듈이 이전 모듈에 의존하므로, 순서대로 구현하면서 테스트 가능
2. **점진적 검증** - 각 단계마다 Ollama 연결, 임베딩 생성 등을 검증할 수 있음
3. **디버깅 용이** - 문제가 생기면 최근 추가된 부분만 확인하면 됨
4. **유연한 수정** - 초기 구현 후 피드백을 받아 다음 모듈에 반영 가능
5. **번들 크기** - 불필요한 코드 작성 방지

## 추천 구현 순서

```
1️⃣ config.py           → 모든 모듈의 기초
2️⃣ schemas.py          → 데이터 모델 정의
3️⃣ ollama_client.py    → Ollama 통신 테스트
4️⃣ embedding.py        → 임베딩 생성 검증
5️⃣ vector_store.py     → 벡터 저장소 동작 확인
6️⃣ retriever.py        → 검색 기능 테스트
7️⃣ rag.py              → 전체 파이프라인 통합
8️⃣ indexer.py          → 자동화 기능
9️⃣ converter.py 업데이트 → FastAPI 엔드포인트 추가
```

## 각 단계별 체크포인트

- **Step 1-2**: 설정과 데이터 모델 준비 완료
- **Step 3**: Ollama 서버 연결 확인
- **Step 4**: 벡터 생성 및 차원 검증
- **Step 5**: 벡터 저장/로드 동작 확인
- **Step 6**: 유사도 검색 결과 확인
- **Step 7**: 쿼리에 대한 답변 생성 확인
- **Step 8**: 자동 인덱싱 동작 확인
- **Step 9**: API 통합 테스트

이렇게 하면 각 모듈을 독립적으로 테스트하면서도, 전체 시스템이 어떻게 보일지 미리 생각하고 조정할 수 있습니다.

**지금 바로 Step 1 (`config.py`)부터 시작할까요?**